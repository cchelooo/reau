<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR.js with 3D Models</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.rawgit.com/jeromeetienne/AR.js/1.7.0/aframe/build/aframe-ar.js"></script>
</head>
<body style="margin: 0; overflow: hidden;">
    <a-scene embedded arjs>
        <!-- Marcador personalizado -->
        <a-marker preset="hiro" id="hiroMarker">
            <!-- Cargamos un modelo 3D .gltf sobre el marcador -->
            <a-entity
                id="gltfModel"
                gltf-model="url(scene.gltf)"
                scale="0.1 0.1 0.1"
                position="0 0 0">
            </a-entity>
        </a-marker>
        <a-entity camera></a-entity>
    </a-scene>

    <script>
        // Seleccionamos el marcador y el modelo
        const marker = document.querySelector("#hiroMarker");
        const model = document.querySelector("#gltfModel");

        // Variable para alternar entre tamaños
        let isSmall = false;

        // Evento para ajustar el tamaño según la distancia
        marker.addEventListener("markerFound", (event) => {
            const intervalId = setInterval(() => {
                const markerPosition = marker.object3D.position.length(); // Distancia del marcador a la cámara
                const scaleFactor = Math.min(Math.max(markerPosition / 5, 0.1), 1); // Ajusta el tamaño según la distancia
                model.setAttribute('scale', `${scaleFactor} ${scaleFactor} ${scaleFactor}`);
            }, 100); // Actualiza cada 100ms
            marker.addEventListener("markerLost", () => clearInterval(intervalId)); // Detiene cuando el marcador se pierde
        });

        // Escuchamos el evento de clic en toda la escena
        document.addEventListener('click', () => {
            // Alterna entre grande y pequeño (50% del tamaño actual)
            const currentScale = model.getAttribute('scale'); // Obtiene el tamaño actual
            if (isSmall) {
                // Regresa al tamaño original (dobla el tamaño actual)
                model.setAttribute('scale', `${currentScale.x * 2} ${currentScale.y * 2} ${currentScale.z * 2}`);
            } else {
                // Reduce al 50% del tamaño actual
                model.setAttribute('scale', `${currentScale.x * 0.5} ${currentScale.y * 0.5} ${currentScale.z * 0.5}`);
            }
            isSmall = !isSmall; // Alterna el estado
        });
    </script>
</body>
</html>
